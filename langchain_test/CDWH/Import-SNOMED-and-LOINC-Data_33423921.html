<!DOCTYPE html>
<html>
    <head>
        <title>DataWarehouse : Import SNOMED and LOINC Data</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">DataWarehouse</a></span>
                            </li>
                                                    <li>
                                <span><a href="DataWarehouse_33423377.html">DataWarehouse</a></span>
                            </li>
                                                    <li>
                                <span><a href="Wiki_33424094.html">Wiki</a></span>
                            </li>
                                                    <li>
                                <span><a href="CDWH_33424168.html">CDWH</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            DataWarehouse : Import SNOMED and LOINC Data
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
        
    
        
        
            Created by <span class='author'> Michael Hadorn</span>, last modified by <span class='editor'> Richard Marti</span> on Juli 28, 2022
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <h2 id="ImportSNOMEDandLOINCData-NewimportprocedureforSNOMED,implementedon2ndMay2022">New import procedure for SNOMED, implemented on 2nd May 2022</h2><p style="margin-left: 30.0px;"><strong><span class="legacy-color-text-red2">Always ensure, that the folder on the DS-Server contains the files of both versions, the International version and the Swiss Extension! (Point 7)</span></strong></p><ol><li><p>Download the SNOMED Release from homepage (Credentials in KeePass) and store the ZIP-File in a new folder: <code>I:\Verwaltung\ICT_CDWH\SourceSystem\Snomed\Release_YYYYMMDD\</code></p></li><li><p>Extract the files (with 7Zip, use &quot;Extract here&quot; from the context menu)</p></li><li><p>Copy the subfolder &quot;Full&quot; from the extracted files</p></li><li><p>Go to <code>\\ictsapdaswe01\CDWH\SnomedCT\</code> (SAP Data Services Development Environment) and the delete the existing folder &quot;Full&quot;</p></li><li><p>Paste the copied folder from point 3 here (there is also a README.txt in this folder, that describes the same procedure)</p></li><li>Swiss Extension Step1: Download the latest Swiss Extension, if a new extension has been released</li><li>Swiss Extension Step2: Do always copy the Full-Folder of the Swiss Extension over the new Full-Folder here \\ictsapdaswe01\CDWH\SnomedCT\ in order to have both versions in the (sub)folders</li><li><p>If you added the files of a new release of SnomedCT Swiss Extension, add the official release date to table USERAREA.SNOMED_CH_RELEASEDATES and check whether it corresponds with the latest EFFECTIVETIME in the downloaded files</p></li><li><p>Login to your SAP Data Services Designer and get the latest version of job BJ_LZ_SNOMED from the central repository to your own repository</p></li><li><p>Login to your repository in the SAP Data Services Management Console on <code>ictsapdaswe01.ms.uhbs.ch:8080/DataServices/launch/logon.action</code> and start the job BJ_LZ_SNOMED</p></li><li><p>When the job ran successfully, check the rowcount and the content of all tables in Schema SNOMED on DWHE, and compare with the tables on DWHP</p></li><li><p>In a new release, there are always more records in each table, comparing to a previous release</p></li><li><p>Also check the MAX(EFFECTIVETIME) in the tables, to ensure that the latest release is present</p></li><li><p>When everything looks good, do the same thing on KONS and PROD. The location for the files are different for each environment:</p></li><li><p>KONS: <code>\\ictsapdaswk01\CDWH\SnomedCT\</code></p></li><li><p>PROD: <code>\\ictsapdaswp02\CDWH\SnomedCT\</code></p></li><li><p>SAP Data Services Job BJ_LZ_SNOMED is available in the repositories DSREPO_KONS/DSREPO_PROD</p></li></ol><h2 id="ImportSNOMEDandLOINCData-NewimportprocedureforLOINC,implementedon6thJune2022:">New import procedure for LOINC, implemented on 6th June 2022:</h2><ol><li><p>Download the LOINC Release from homepage (Credentials in KeePass) and store the ZIP-File in here: <code>I:\Verwaltung\ICT_CDWH\SourceSystem\LOINC\</code></p></li><li><p>Extract the files in a new folder (with 7Zip, use &quot;Extract to Loinc_x.xx&quot; from the context menu)</p></li><li><p>Copy the subfolder &quot;LoincTable&quot; from the extracted files</p></li><li><p>Go to <code>\\ictsapdaswe01\CDWH\Loinc\</code> (SAP Data Services Development Environment) and the delete the existing folder &quot;LoincTable&quot;</p></li><li><p>Paste the copied folder from point 3 here (there is also a README.txt in this folder, that describes the same procedure)</p></li><li><p>Login to your SAP Data Services Designer and get the latest version of job BJ_LZ_LOINC from the central repository to your own repository</p></li><li><p>Login to your repository in the SAP Data Services Management Console on <code><a href="http://ictsapdaswe01.ms.uhbs.ch" class="external-link" rel="nofollow">ictsapdaswe01.ms.uhbs.ch</a>:8080/DataServices/launch/logon.action</code> and start the job BJ_LZ_LOINC</p></li><li><p>When the job ran successfully, check the rowcount and the content of table LOINC in Schema LOINC on DWHE, and compare with the same table on DWHP</p></li><li><p>In a new release, there are always more records, comparing to a previous release</p></li><li><p>Also check the MAX(VERSIONLASTCHANGED) in the table, to ensure that the latest release is present</p></li><li><p>When everything looks good, do the same thing on KONS and PROD. The location for the files are different for each environment:</p></li><li><p>KONS: <code>\\ictsapdaswk01\CDWH\Loinc\</code></p></li><li><p>PROD: <code>\\ictsapdaswp02\CDWH\Loinc\</code></p></li><li><p>SAP Data Services Job BJ_LZ_LOINC is available in the repositories DSREPO_KONS/DSREPO_PROD</p></li></ol><h2 id="ImportSNOMEDandLOINCData-Old,manualimportprocedure(donotuseanymore!)"><s>Old, manual import procedure (do not use anymore!)</s></h2><p><s>All information, which is required to download the latest version of SNOMED/LOINC, is stored in the CDWH KeyPass file. After downloading the latest release, follow these steps:</s></p><ol><li><s>Copy all relevant text files into one folder. To identified, which files are relevant for the CDWH, you can check the related LZ-Schema on the DB.</s></li><li><s>Create a new connection in DBeaver. Depending von the source (SNOMED or LOINC), the connection type differs. Connection for <strong>SNOMED</strong>:</s><br/><s>2.1 Connection type: DBF (Flat File), with the new file path as destination.</s><br/><s>2.2 Configure the driver settings (the &quot;quotechar&quot; character for copy &amp; paste <code>¦</code>)</s><br/><s><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="400" loading="lazy" src="attachments/33423921/33443755.png?height=400" data-image-src="attachments/33423921/33443755.png" data-unresolved-comment-count="0" data-linked-resource-id="33443755" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="b757de0984dc7019dce20592dd46e3d4_image.png" data-base-url="https://usbch.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="33423921" data-linked-resource-container-version="13" data-media-id="bfce4457-7024-49c0-be8a-4cbe931499db" data-media-type="file"></span></s><br/><s>2.3 Finish the setup. The text files should now be available to be queried by DBeaver.</s></li><li><s>Connection for <strong>LOINC</strong>:</s><br/><s>3.1 Connection type: CSV, with the new file path as destination.</s><br/><s>3.2 Configure the driver settings</s><br/><s><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="400" loading="lazy" src="attachments/33423921/33443737.png?height=400" data-image-src="attachments/33423921/33443737.png" data-unresolved-comment-count="0" data-linked-resource-id="33443737" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="c6635084f311d0c72cdde6450ff53dc9_image.png" data-base-url="https://usbch.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="33423921" data-linked-resource-container-version="13" data-media-id="ada1d1b2-4cdc-42b0-be4c-20799679c17d" data-media-type="file"></span></s><br/><s>3.3 Finish the setup. The text files should now be available to be queried by DBeaver.</s></li><li><s>Before you start to import the files, you should prepare two things:</s><br/><s>4.1 Make sure, that the target tables are empty.</s><br/><s>4.2 During the import process, the data types must be mapped to the target columns. Note/Prepare them before you start with the process. The DBeaver application is &quot;blocked&quot; by the import function.</s></li><li><s>Create a new task vai the DBeaver context menu: <code>Database</code> → <code>Tasks</code> → <code>Create Task</code>.</s></li><li><s>Add the text files (&quot;tables&quot;). You can mark multiple tables at once.</s><br/><s><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="400" loading="lazy" src="attachments/33423921/33443731.png?height=400" data-image-src="attachments/33423921/33443731.png" data-unresolved-comment-count="0" data-linked-resource-id="33443731" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="db8128ab55d43abc15ee8179a7e04bb2_image.png" data-base-url="https://usbch.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="33423921" data-linked-resource-container-version="13" data-media-id="28fd9b00-140d-4548-b30e-79cb50ca56b4" data-media-type="file"></span></s></li><li><s>Choose <code>Database</code> as export target in the next step.</s></li><li><s>Check/Setup the target container.</s><br/><s><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" width="750" loading="lazy" src="attachments/33423921/33443743.png?width=750" data-image-src="attachments/33423921/33443743.png" data-unresolved-comment-count="0" data-linked-resource-id="33443743" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="930dc36ef3372490dda36f3391bf835e_image.png" data-base-url="https://usbch.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="33423921" data-linked-resource-container-version="13" data-media-id="abc5b7bf-02f4-48b7-9c45-edf5334a55c0" data-media-type="file"></span></s></li><li><s>Set the target table, for each source table. Including the data type mapping.</s></li></ol>
                    </div>

                                        <div class="pageSection group">
                        <div class="pageSectionHeader">
                            <h2 id="attachments" class="pageSectionTitle">Attachments:</h2>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/33423921/33443755.png">b757de0984dc7019dce20592dd46e3d4_image.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/33423921/33443737.png">c6635084f311d0c72cdde6450ff53dc9_image.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/33423921/33443731.png">db8128ab55d43abc15ee8179a7e04bb2_image.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/33423921/33443743.png">930dc36ef3372490dda36f3391bf835e_image.png</a> (image/png)
                                <br/>
                                                    </div>
                    </div>
                    
                                                      
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on Okt. 26, 2023 18:01</p>
                    <div id="footer-logo"><a href="http://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
